var dragThrow=function(){var e=!1,t=0,n=0,r=0,i=0,s=0,o=0,u,a,f=!1,l=!1,c,h=100,p=5,d=0,v=3,m=0,g="scroll",y=!1;this.targetObject=undefined;this.eventObject=undefined;this.originalGravity=0;this.moveY=!0;this.moveX=!0;this.originalDecay=.8;this.onlyTarget=!0;this.xOppositeEdge=!1;this.yOppositeEdge=!1;this.percentage=1;this.doZoom=!0;this.minPercent=.2;this.maxPercent=2;this.handleOverTarget=function(e){e.preventDefault();var u=this.findElement(e.target);f=!0;r=t=s=e.clientX||e.touches.item(0).clientX;i=n=o=e.clientY||e.touches.item(0).clientY;l=u===this.targetObject;this.checkSize();e.touches&&this.touchZoom(e.touches)};this.moveIt=function(c){c.preventDefault();this.onlyTarget||(l=!0);if(f&&l){f=!0;e=!0;s=c.clientX||c.touches.item(0).clientX;o=c.clientY||c.touches.item(0).clientY;c.touches&&this.touchZoom(c.touches,!0);r=t;i=n;var h=o-n+this.targetObject.offsetTop,p=s-t+this.targetObject.offsetLeft;this.moveY&&(this.targetObject.style.top=h+"px");this.moveX&&(this.targetObject.style.left=p+"px");if(!y){this.findEdgeY(0);this.findEdgeX(0)}u=this.originalDecay;a=this.originalGravity;v=3;d=0}else{f=!1;this.onlyTarget||(l=!1)}t=s;n=o};this.checkSize=function(){this.xOppositeEdge=this.targetObject.offsetWidth>this.eventObject.offsetWidth;this.yOppositeEdge=this.targetObject.offsetHeight>this.eventObject.offsetHeight};this.touchZoom=function(e,t){if(this.doZoom)if(e.length>1){var n=Math.sqrt(Math.pow(o-e.item(1).clientY,2)+Math.pow(s-e.item(1).clientX,2)),r=(n-m)*(this.targetObject.offsetHeight/100),i=e.item(0).clientX-(e.item(0).clientX-e.item(1).clientX)/2,u=e.item(0).clientY-(e.item(0).clientY-e.item(1).clientY)/2,a=i-this.eventObject.offsetLeft-this.targetObject.offsetLeft,f=u-this.eventObject.offsetTop-this.targetObject.offsetTop;t&&this.zoom(a,f,r);this.checkSize();m=n;y=!0}else y=!1};this.mouseZoom=function(e){if(this.doZoom){e.preventDefault();e.stopPropagation();e=e?e:window.event;var t=Math.ceil((e.detail?e.detail*-1:e.wheelDelta/40)*20),n=e.clientX-this.eventObject.offsetLeft-this.targetObject.offsetLeft,r=e.clientY-this.eventObject.offsetTop-this.targetObject.offsetTop;this.zoom(n,r,t)}};this.zoom=function(e,t,n){n=Math.ceil(n*10)/10;var r=this.targetObject.offsetHeight,i=this.targetObject.offsetWidth;if(g==="tooFarUp"&&n<0||g==="tooFarDown"&&n>0)g="scroll";HP=t/this.targetObject.offsetHeight;WP=e/this.targetObject.offsetWidth;if(this.targetObject.offsetHeight>this.targetObject.naturalHeight*this.maxPercent&&g==="scroll"){this.targetObject.style.height=this.targetObject.naturalHeight*this.maxPercent+"px";g="tooFarUp"}else if(this.targetObject.offsetHeight<this.targetObject.naturalHeight*this.minPercent&&g){this.targetObject.style.height=this.targetObject.naturalHeight*this.minPercent+"px";g="tooFarDown"}else g==="scroll"?this.targetObject.style.height=this.targetObject.offsetHeight+n+"px":n=0;this.targetObject.style.width=this.targetObject.offsetHeight*(this.targetObject.naturalWidth/this.targetObject.naturalHeight)+"px";r=this.targetObject.offsetHeight-r;i=this.targetObject.offsetWidth-i;this.targetObject.style.top=this.targetObject.offsetTop-r*HP+"px";this.targetObject.style.left=this.targetObject.offsetLeft-i*WP+"px";this.checkSize();this.percentage=1};this.throwIt=function(t){t.preventDefault();f=!1;e&&(c=setTimeout(this.theRepeater.bind(this),p))};this.findElement=function(e){while(e!==this.targetObject){if(e===this.eventObject||e===null)break;e=e.parentNode}return e};this.findEdgeY=function(e){if(this.yOppositeEdge){if(this.targetObject.offsetTop<this.eventObject.offsetHeight-this.targetObject.offsetHeight-20){e=-0.1*e;i=o;this.targetObject.style.top=this.eventObject.offsetHeight-this.targetObject.offsetHeight-20+"px"}if(this.targetObject.offsetTop>20){e=-0.1*e;i=o;this.targetObject.style.top="20px"}}else{if(this.targetObject.offsetTop<0){e=-1*e;this.targetObject.style.top="0px"}if(this.targetObject.offsetTop>this.eventObject.offsetHeight-this.targetObject.offsetHeight){e=-1*e;this.targetObject.style.top=this.eventObject.offsetHeight-this.targetObject.offsetHeight+1+"px"}}return e};this.findEdgeX=function(e){if(this.xOppositeEdge){if(this.targetObject.offsetLeft<this.eventObject.offsetWidth-this.targetObject.offsetWidth-20){e=-0.1*e;r=s;this.targetObject.style.left=this.eventObject.offsetWidth-this.targetObject.offsetWidth-20+"px"}if(this.targetObject.offsetLeft>20){e=-0.1*e;r=s;this.targetObject.style.left="20px"}}else{if(this.targetObject.offsetLeft<0){e=-1*e;this.targetObject.style.left="0px"}if(this.targetObject.offsetLeft>this.eventObject.offsetWidth-this.targetObject.offsetWidth){e=-1*e;this.targetObject.style.left=this.eventObject.offsetWidth-this.targetObject.offsetWidth+"px"}}return e};this.theRepeater=function(e){clearTimeout(this.t);var t=s,n=o,l=!1,h=s-r,m=o-i;if(!f){h*=u;m*=u;m<0?m+=a:m+=a*(1-a);m<0&&d>0&&(v=d);d=m;h=this.findEdgeX(h);m=this.findEdgeY(m);var g=h+this.targetObject.offsetLeft,y=m+this.targetObject.offsetTop;s+=h;o+=m;this.moveY&&(this.targetObject.style.top=y+"px");this.moveX&&(this.targetObject.style.left=g+"px");r=t;i=n;if(this.originalDecay<1){u-=.001;a=0;l=!0}else if(a&&v>2)u-=1e-5;else if(v<2){u-=.001;l=!0}c=setTimeout(this.theRepeater.bind(this),p);Math.abs(h)<.5&&Math.abs(m)<.5&&l&&clearTimeout(c)}}};dragThrow.prototype.init=function(e){this.targetObject=e.targetObject;this.eventObject=e.eventObject;if(this.targetObject.nodeName.toLowerCase()=="img"&&typeof this.targetObject.naturalHeight=="undefined"){var t=new Image;t.src=this.targetObject.src;this.targetObject.naturalHeight=t.height;this.targetObject.naturalWidth=t.width}this.originalDecay=typeof e.decay!="undefined"?e.decay:.8;this.originalGravity=typeof e.gravity!="undefined"?e.gravity:0;this.moveX=typeof e.moveX!="undefined"?e.moveX:!0;this.moveY=typeof e.moveY!="undefined"?e.moveY:!0;this.onlyTarget=typeof e.onlyTarget!="undefined"?e.onlyTarget:!0;this.doZoom=typeof e.doZoom!="undefined"?e.doZoom:!0;this.minPercent=typeof e.minPercent!="undefined"?e.minPercent:.2;this.maxPercent=typeof e.maxPercent!="undefined"?e.maxPercent:2;this.start()};dragThrow.prototype.start=function(){if(this.eventObject.addEventListener){this.eventObject.addEventListener("mousedown",this.handleOverTarget.bind(this),!1);this.eventObject.addEventListener("mousemove",this.moveIt.bind(this),!1);document.addEventListener("mouseup",this.throwIt.bind(this),!1);this.eventObject.addEventListener("touchstart",this.handleOverTarget.bind(this),!1);this.eventObject.addEventListener("touchend",this.throwIt.bind(this),!1);this.eventObject.addEventListener("touchmove",this.moveIt.bind(this),!1);this.targetObject.addEventListener("mousedown",this.handleOverTarget.bind(this),!1);this.targetObject.addEventListener("touchstart",this.handleOverTarget.bind(this),!1);this.eventObject.addEventListener("DOMMouseScroll",this.mouseZoom.bind(this),!1);this.eventObject.addEventListener("mousewheel",this.mouseZoom.bind(this),!1)}else if(this.eventObject.attachEvent){this.eventObject.attachEvent("onmousewheel",this.bind(this.mouseZoom,this));this.eventObject.attachEvent("mousedown",this.bind(this.handleOverTarget,this));this.eventObject.attachEvent("onmousemove",this.bind(this.moveIt,this));document.attachEvent("onmouseup",this.bind(this.throwIt,this));this.eventObject.attachEvent("ontouchstart",this.bind(this.handleOverTarget,this));this.eventObject.attachEvent("ontouchend",this.bind(this.throwIt,this));this.eventObject.attachEvent("ontouchmove",this.bind(this.moveIt,this));this.targetObject.attachEvent("onmousedown",this.bind(this.handleOverTarget,this));this.targetObject.attachEvent("ontouchstart",this.bind(this.handleOverTarget,this))}};dragThrow.prototype.percentageZoom=function(e){};typeof function(){}.bind=="undefined"&&(this.prototype.bind=function(e,t){return function(){return e.apply(t,arguments)}});dragThrow.prototype.stop=function(){this.eventObject.removeEventListener("mousedown",this.handleOverTarget,!1);this.eventObject.removeEventListener("mousemove",this.moveIt,!1);document.removeEventListener("mouseup",this.throwIt);this.eventObject.removeEventListener("touchstart",this.handleOverTarget,!1);this.eventObject.removeEventListener("touchend",this.throwIt,!1);this.eventObject.removeEventListener("touchmove",this.moveIt,!1);this.targetObject.removeEventListener("mousedown",this.handleOverTarget,!1);this.targetObject.removeEventListener("touchstart",this.handleOverTarget,!1)};